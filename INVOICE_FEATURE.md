# 收據匯出功能 (Invoice Export Feature)

## 功能說明

此功能允許為所有參賽選手匯出繳費收據，用於記錄會費或其他費用的收取。

## 使用方法

### 1. 進入選手管理頁面
- 點選「選手管理」分頁
- 確保已新增選手資料

### 2. 匯出收據
- 點選「🧾 匯出收據」按鈕
- 系統會依序提示輸入以下資訊：

#### 必填欄位：
1. **年份** (預設為當前民國年份)
   - 例如：115
   
2. **費用類型** (預設為「會費」)
   - 例如：會費、報名費、保證金
   
3. **金額** (預設為 3000 元)
   - 例如：3000
   
4. **組織名稱** (預設為「新北市中和區錦和網球聯誼會」)
   - 可自訂組織全名

### 3. 選擇匯出格式
系統提供三種格式選擇：

#### 格式 1: Excel (推薦)
- 適合需要編輯或整理的情況
- 每頁 2 欄 × 3 列 = 6 張收據
- 自動套用格式和樣式
- 需安裝 Microsoft Excel 或 Google Sheets

#### 格式 2: 網頁列印 (大張)
- 每張收據為 A5 橫向格式
- 適合單獨列印每張收據
- 每頁一張，格式大方
- 直接使用瀏覽器列印

#### 格式 3: 網頁列印 (信用卡大小) ⭐推薦
- **每頁可印 10 張收據** (2 欄 × 5 列)
- 收據大小：90mm × 55mm (接近信用卡尺寸)
- 最節省紙張，適合大量列印
- 使用 A4 紙張列印
- 可直接裁切使用

### 4. 列印或儲存
- 系統會在新視窗中生成所有選手的收據
- 使用瀏覽器的列印功能 (Ctrl+P) 列印
- 可以另存為 PDF 檔案保存

## 收據格式

### 格式 1 & 2: 傳統大張收據
收據採用中文傳統格式，包含以下內容：

```
收據

茲收到 {選手姓名} {年份}年{費用類型}{金額}元

{組織名稱}

財務: [經辦人章]
```

#### 範例：
```
收據

茲收到 許僑方　115年會費3000元

新北市中和區錦和網球聯誼會

財務: [經辦人章]
```

### 格式 3: 精簡信用卡尺寸收據 ⭐

精簡版收據適合大量列印，每張收據約為信用卡大小 (90mm × 55mm)：

```
┌─────────────────────────┐
│      收　據             │
├─────────────────────────┤
│ 茲收到 許僑方           │
│ 115年 會費             │
│ 金額 3000 元           │
│ 新北市中和區錦和網球...  │
├─────────────────────────┤
│ 財務經辦    [經辦人章]   │
└─────────────────────────┘
```

**優點：**
- 每張 A4 紙可印 10 張收據 (2×5排列)
- 節省紙張成本
- 便於攜帶和分發
- 可裁切後收納於錢包

## 技術實作

### 檔案說明

1. **src/utils/invoiceGenerator.ts**
   - 收據生成工具函式
   - `generateInvoiceHTML()` - 生成單一選手收據 (大張)
   - `generateAllInvoicesHTML()` - 生成所有選手收據 (大張)
   - `generateCompactInvoicesHTML()` - 生成精簡版收據 (信用卡大小)
   - `exportPlayerInvoices()` - 匯出大張收據
   - `exportCompactInvoices()` - 匯出精簡版收據
   - `exportPlayerInvoicesExcel()` - 匯出 Excel 格式收據

2. **src/types/index.ts**
   - 新增 `InvoiceSettings` 介面
   - 定義收據所需的欄位結構

3. **src/App.tsx**
   - 新增 `handleExportInvoices()` 函式
   - 處理使用者輸入和收據匯出邏輯

4. **src/components/PlayerManagement.tsx**
   - 新增「匯出收據」按鈕
   - 整合收據匯出功能到選手管理介面

## 樣式特色

### 大張收據 (格式 1 & 2):
- 淡藍色漸層背景，呼應傳統收據紙張
- 大字體設計，方便列印後閱讀
- A5 橫向格式，節省紙張成本
- 紅色印章框線設計
- 響應式設計，支援列印預覽

### 精簡收據 (格式 3):
- 信用卡大小 (90mm × 55mm)
- 緊湊排版，保留完整資訊
- 每頁 A4 可印 10 張 (2 欄 × 5 列)
- 淡藍色漸層背景
- 邊框清晰，便於裁切
- 列印資訊顯示：總張數、頁數、格式

## 注意事項

1. 收據生成前請確保選手資料已完整建立
2. 建議列印前先預覽確認格式正確
3. 可使用瀏覽器的「另存為 PDF」功能保存電子檔
4. 印章處需手動蓋章或簽名
5. 每次匯出都需重新輸入收據設定，確保資料準確

## 列印設定建議

### 大張收據 (格式 2):
- 紙張大小：A5
- 方向：橫向 (Landscape)
- 邊界：10mm
- 建議使用彩色列印以呈現背景漸層效果

### 精簡收據 (格式 3) ⭐推薦:
- 紙張大小：A4
- 方向：直向 (Portrait)
- 邊界：8mm
- 每頁自動排列 10 張收據
- 建議使用彩色列印
- 列印後可沿邊框裁切
- 適合使用裁紙機大量裁切

### Excel 格式 (格式 1):
- 開啟 Excel 後自行調整列印設定
- 建議紙張大小：A4
- 每頁 6 張收據 (2 欄 × 3 列)
- 可在 Excel 中自行調整樣式和內容

- **紙張大小**: A5 橫向 (148mm x 210mm)
- **邊界**: 10mm (上下左右)
- **色彩**: 彩色（保留漸層背景）或黑白
- **雙面列印**: 單面

## 未來擴充可能

- [ ] 儲存收據設定，避免重複輸入
- [ ] 支援匯出為 PDF 檔案
- [ ] 支援自訂收據範本
- [ ] 支援批次列印特定隊伍
- [ ] 支援加入組織 Logo
- [ ] 支援電子簽章功能
